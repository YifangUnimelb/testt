```{r}

# plot of log_cpi forecasts
############################################################
limits.1    = range(Y.h[,1,])
point.f.cpi.t    = apply(Y.h[,1,],1,mean)
interval.f.cpi.t  = apply(Y.h[,1,],1,hdi,credMass=0.68)

x           = seq(from=limits.1[1], to=limits.1[2], length.out=100)
z           = matrix(NA,h,99)
for (i in 1:h){
  z[i,]     = hist(Y.h[i,1,], breaks=x, plot=FALSE)$density
}
x           = hist(Y.h[i,1,], breaks=x, plot=FALSE)$mids
yy          = 1:h
z           = t(z)

pdf(file=paste("predictive-log_cpi-horizons_t.pdf",sep=""), width=9,height=7)
theta = 180
phi   = 15.5
f4    = persp3D(x=x, y=yy, z=z, phi=phi, theta=theta, xlab="\nlog_cpi[t+h|t]", ylab="h", zlab="\npredictive densities of log_cpi", shade=NA, border=NA, ticktype="detailed", nticks=3,cex.lab=1, col=NA,plot=FALSE)
perspbox (x=x, y=yy, z=z, bty="f", col.axis="black", phi=phi, theta=theta, xlab="\nlog_cpi[t+h|t]", ylab="h", zlab="\npredictive densities of log_cpi", ticktype="detailed", nticks=3,cex.lab=1, col = NULL, plot = TRUE)
polygon3D(x=c(interval.f[1,],interval.f[2,h:1]), y=c(1:h,h:1), z=rep(0,2*h), col = "grey", NAcol = "white", border = NA, add = TRUE, plot = TRUE)
for (i in 1:h){
  f4.l = trans3d(x=x, y=yy[i], z=z[,i], pmat=f4)
  lines(f4.l, lwd=0.5, col="black")
}
f4.l1 = trans3d(x=point.f, y=yy, z=0, pmat=f4)
lines(f4.l1, lwd=2, col="black")
dev.off()

# plot of cr forecasts
############################################################
limits.1    = range(Y.h[,5,])
point.f.cr.t    = apply(Y.h[,5,],1,mean)
interval.f.cr.t  = apply(Y.h[,5,],1,hdi,credMass=0.68)

x           = seq(from=limits.1[1], to=limits.1[2], length.out=100)
z           = matrix(NA,h,99)
for (i in 1:h){
  z[i,]     = hist(Y.h[i,5,], breaks=x, plot=FALSE)$density
}
x           = hist(Y.h[i,5,], breaks=x, plot=FALSE)$mids
yy          = 1:h
z           = t(z)

pdf(file=paste("predictive-cash_rate-horizons_t.pdf",sep=""), width=9,height=7)
theta = 180
phi   = 15.5
f4    = persp3D(x=x, y=yy, z=z, phi=phi, theta=theta, xlab="\ncash_rate[t+h|t]", ylab="h", zlab="\npredictive densities of cash_rate", shade=NA, border=NA, ticktype="detailed", nticks=3,cex.lab=1, col=NA,plot=FALSE)
perspbox (x=x, y=yy, z=z, bty="f", col.axis="black", phi=phi, theta=theta, xlab="\ncash_rate[t+h|t]", ylab="h", zlab="\npredictive densities of cash_rate", ticktype="detailed", nticks=3,cex.lab=1, col = NULL, plot = TRUE)
polygon3D(x=c(interval.f[1,],interval.f[2,h:1]), y=c(1:h,h:1), z=rep(0,2*h), col = "grey", NAcol = "white", border = NA, add = TRUE, plot = TRUE)
for (i in 1:h){
  f4.l = trans3d(x=x, y=yy[i], z=z[,i], pmat=f4)
  lines(f4.l, lwd=0.5, col="black")
}
f4.l1 = trans3d(x=point.f, y=yy, z=0, pmat=f4)
lines(f4.l1, lwd=2, col="black")
dev.off()
# plot of log_cpi forecasts
############################################################
limits.f.cpi    = range(Y.h[,1,])
point.f.cpi     = apply(Y.h[,1,],1,mean)
interval.f.cpi  = apply(Y.h[,1,],1,hdi,credMass=0.68)

x           = seq(from=limits.1[1], to=limits.1[2], length.out=100)
z           = matrix(NA,h,99)
for (i in 1:h){
  z[i,]     = hist(Y.h[i,1,], breaks=x, plot=FALSE)$density
}
x           = hist(Y.h[i,1,], breaks=x, plot=FALSE)$mids
yy          = 1:h
z           = t(z)

pdf(file=paste("predictive-log_cpi-horizons.pdf",sep=""), width=9,height=7)
theta = 180
phi   = 15.5
f4    = persp3D(x=x, y=yy, z=z, phi=phi, theta=theta, xlab="\nlog_cpi[t+h|t]", ylab="h", zlab="\npredictive densities of log_cpi", shade=NA, border=NA, ticktype="detailed", nticks=3,cex.lab=1, col=NA,plot=FALSE)
perspbox (x=x, y=yy, z=z, bty="f", col.axis="black", phi=phi, theta=theta, xlab="\nlog_cpi[t+h|t]", ylab="h", zlab="\npredictive densities of log_cpi", ticktype="detailed", nticks=3,cex.lab=1, col = NULL, plot = TRUE)
polygon3D(x=c(interval.f.cpi[1,],interval.f.cpi[2,h:1]), y=c(1:h,h:1), z=rep(0,2*h), col = "grey", NAcol = "white", border = NA, add = TRUE, plot = TRUE)
for (i in 1:h){
  f4.l = trans3d(x=x, y=yy[i], z=z[,i], pmat=f4)
  lines(f4.l, lwd=0.5, col="black")
}
f4.l1 = trans3d(x=point.f, y=yy, z=0, pmat=f4)
lines(f4.l1, lwd=2, col="black")
dev.off()

# plot of cr forecasts
############################################################
limits.f.cr    = range(Y.h[,5,])
point.f.cr     = apply(Y.h[,5,],1,mean)
interval.f.cr  = apply(Y.h[,5,],1,hdi,credMass=0.68)

x           = seq(from=limits.1[1], to=limits.1[2], length.out=100)
z           = matrix(NA,h,99)
for (i in 1:h){
  z[i,]     = hist(Y.h[i,5,], breaks=x, plot=FALSE)$density
}
x           = hist(Y.h[i,5,], breaks=x, plot=FALSE)$mids
yy          = 1:h
z           = t(z)

pdf(file=paste("predictive-cash_rate-horizons.pdf",sep=""), width=9,height=7)
theta = 180
phi   = 15.5
f4    = persp3D(x=x, y=yy, z=z, phi=phi, theta=theta, xlab="\ncash_rate[t+h|t]", ylab="h", zlab="\npredictive densities of cash_rate", shade=NA, border=NA, ticktype="detailed", nticks=3,cex.lab=1, col=NA,plot=FALSE)
perspbox (x=x, y=yy, z=z, bty="f", col.axis="black", phi=phi, theta=theta, xlab="\ncash_rate[t+h|t]", ylab="h", zlab="\npredictive densities of cash_rate", ticktype="detailed", nticks=3,cex.lab=1, col = NULL, plot = TRUE)
polygon3D(x=c(interval.f[1,],interval.f[2,h:1]), y=c(1:h,h:1), z=rep(0,2*h), col = "grey", NAcol = "white", border = NA, add = TRUE, plot = TRUE)
for (i in 1:h){
  f4.l = trans3d(x=x, y=yy[i], z=z[,i], pmat=f4)
  lines(f4.l, lwd=0.5, col="black")
}
f4.l1 = trans3d(x=point.f, y=yy, z=0, pmat=f4)
lines(f4.l1, lwd=2, col="black")
dev.off()

```