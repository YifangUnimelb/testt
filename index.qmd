---
title: "Title of your work"
author: "Your Name"

execute:
  echo: false
  
bibliography: references.bib
---

> **Abstract.** This is a suggested formatting for your abstract. This **quarto** document is a template for your report. It includes some basic ways of working with such documents. You are invited to learn more about developing online reports with this technology. 
>
> **Keywords.** bsvars, impulse responses, quarto, R, tax shocks

# Introduction

This is a template repository for the Research Report for **Macroeconometrics**. Learn more about about developing online reports with **quarto** at [quarto.org](https://quarto.org/).

## A Simple Example

This is a Quarto document in which we can cite the **bsvars** package by @wozniakBsvarsBayesianEstimation2022. Look for more info at [package CRAN website](https://cran.r-project.org/package=bsvars).

Simply load the package by running
```{r package load}
library(bsvars)
```

The code below performs simple computations for sampling posterior draws of the impulse responses. The first line uploads the data from the package,another sets the seed for reproducible computations, and then the pipe `|>` is used to streamline the model specification, estimation including the first burn-in run to obtain convergence and finally, the computed impulse responses are saved in object `irf`.
```{r estimate irf}
#| message: false
#| echo: true

data(us_fiscal_lsuw)
set.seed(123)
us_fiscal_lsuw |>
  specify_bsvar$new(p = 1) |>
  estimate(S = 1000, show_progress = FALSE) |> 
  estimate(S = 2000, show_progress = FALSE) |> 
  compute_impulse_responses(horizon = 20) -> irf
```

The code above is visible as the **R** chunk contains the setting `#| echo: true`.

@tbl-irf reports the posterior means of the gross domestic product response to an unanticipated tax increase by 1 pp.
```{r}
#| label: tbl-irf
#| tbl-cap: Impulse response of gdp to unanticipated tax increase by 1 pp. within two years

irf_gdp_tax = matrix(apply(irf[3,1,1:9,],1, mean), nrow = 1)
rownames(irf_gdp_tax) = "change in gdp [%]"
colnames(irf_gdp_tax) = 0:8
knitr::kable(irf_gdp_tax, digits = 3)
```

@fig-irf presents the same reaction over the horizon of five years.
```{r}
#| label: fig-irf
#| fig-cap: Impulse response of gdp to unanticipated tax increase by 1 pp. within five years

irf_median    = apply(irf[3,1,,],1, median)
irf_hdi       = apply(irf[3,1,,],1, HDInterval::hdi, credMass = .68)
plot(x = 0:20, y = irf_median, type = "l", bty = "n", 
     xlab = "horizon", ylab = "change in gdp [%]",
     ylim = range(irf_hdi))
polygon(x = c(0:20, 20:0), y = c(irf_hdi[1,], irf_hdi[2,21:1]), col = "deepskyblue1", border = "deepskyblue1")
lines(x = 0:20, y = irf_median, lwd = 2, col = "deepskyblue3")
```

## Some Hints

Have a look at how to work with **RStudio** and **GitHub** at: [How to use git and GitHub with R](https://rfortherestofus.com/2021/02/how-to-use-git-github-with-r/). 

These are many different ways of how to work with references in **RStudio**: [Preview Citations](https://posit.co/blog/rstudio-1-4-preview-citations/).

To make all the **R** code visible on the website change the settings in the preabmble of this document to:
```
execute:
  echo: true
```
<<<<<<< HEAD

## Augmented Dickey-Fuller

```{r ADF}
#| echo: false
#| message: false
#| warning: false

library(tseries)

adf.test(data_trans$cpi_log)
adf.test(data_trans$gdp_log)
adf.test(data_trans$m1_log)
adf.test(data_trans$m3_log)
adf.test(data_trans$cr)
adf.test(data_trans$un_em)

p_value <- c(0.01796, 0.01, 0.02154, 0.1622, 0.01, 0.3884)
ADF_stats <- c(-3.8653, -5.765, -3.7918,-2.9958, -4.3135,-2.4522)
Variable <- c("CPI_log", "GDP_log","M1_log","M3_log","Cash rate","Unemployment")

adf_res <- cbind(Variable,ADF_stats , p_value)

library(knitr)
install.packages("kableExtra")
library(kableExtra)

kbl(adf_res) %>%
  kable_styling(bootstrap_options = c("striped", "hover"))

```

# Model

Here presents the Bayesian VAR with Stochastic Student-t volatility, the general form of a VAR(p):

$$y_t = a_0 +A_1y_{t-1}+...+A_py_{t-p}+ \epsilon_t $$

where $y_t$ is a $n \times 1$ vector and $n$ is the number of variables. $a_0$ is the $n \times 1$ intercept vector. $A_p$ is $n \times n$ coefficient matrix for each lag order $p$. Put it in compact matrix notation:

$$Y = XA+E$$ where $Y_{T \times n}=(y_1', y_2',...,y_T')'$, $X_{T \times K}=(x_1', x_2',...,x_T')'$. Each $x_{K \times 1}=(1, y_{t-1}',...,y_{t-p}')'$. $A$ is a compact coefficient matrix $A_{K \times n}=(a_0', A_1',...,A_p')'$ and $E_{T \times n}=(\epsilon_1', \epsilon_2',...,\epsilon_T')'$. Note, $K = 1+pn$.

In standard form, the error term is normally distributed $\epsilon_t \sim iidN(0, \Sigma)$, or $E \sim MN(0, \Sigma \otimes I_T)$. $\Sigma$ is a $n \times n$ covariance matrix and $I_T$ is an $T \times T$ identity matrix. In this paper, following Hartwig(2022), I use the specification:

$$\epsilon_t \sim N(0, \Sigma \cdot \lambda_t \cdot exp(h_t))$$

where $\lambda_t \sim IG(\nu/2,\nu/2)$ and $h_t$ follows: $h_t = \rho h_{t-1}+ \epsilon^{h}_{t}$, with $|\rho|< 1$ and $\epsilon^{h}_{t} \sim N(0, \sigma^{2}_h)$. Then the compact distribution of $E \sim MN(0,\Sigma \otimes \Omega)$, $\Omega = diag(\lambda_1exp(h_1), \lambda_2exp(h_2),...,\lambda_Texp(h_T))$.

## Bayesian Estimation

<<<<<<< HEAD
# References {.unnumbered}
=======
## References {.unnumbered}
>>>>>>> parent of ac9f991 (all)
=======


# References {.unnumbered}
>>>>>>> parent of a390e77 (test)
